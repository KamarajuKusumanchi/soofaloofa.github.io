<!DOCTYPE html><html lang="en"><head><title>Share multiple mt-daap libraries | Kevin Sookocheff</title><meta name="description" content="Tinker. Tailor. Soldier. Sailor."><meta name="keywords" content=""><meta name="author" content="Kevin Sookocheff"><!-- Meta--><meta charset="utf-8"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="DocPad v6.64.0" /><!--[if lt IE 9]><script async src="//html5shim.googlecode.com/svn/trunk/html5.js"></script><script async src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.2.0/respond.js"></script><![endif]--><!-- Analytics--><script type="text/javascript">

  var _gaq = _gaq || [];
  var pluginUrl = '//www.google-analytics.co.uk/plugins/ga/inpage_linkid.js';
  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
  _gaq.push(['_setAccount', 'UA-20611089-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js'
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link  rel="stylesheet" href="/vendor/bootstrap.min.css" /><link  rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" /><link  rel="stylesheet" href="/styles/style.css" /><link  rel="stylesheet" href="/styles/monokai.css" /></head><body><!-- Navbar--><div class="navbar navbar-default"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target=".navbar-collapse" class="navbar-toggle"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand">Kevin Sookocheff</a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a href="/pages/speaking">Speaking</a></li><li><a href="/blog">Blog</a></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle"> 
Subscribe <b class="caret"></b></a><ul class="dropdown-menu"><li><a href="http://eepurl.com/KJE01">email</a></li><li><a href="http://sookocheff.com/rss.xml">RSS</a></li></ul></li></ul></div></div></div><!-- Container--><!-- Container--><div class="container"><!-- Content--><section id="content" class="content"><section class="page"><div class="page-header"><h1>Share multiple mt-daap libraries</h1></div><div class="page-content"><article class="post"><p><small class="text-muted">Posted on <time datetime="2010-7-3">Tuesday, August 03, 2010</time></small></p><div class="post-content"><p>I recently moved all of our household music to a shared network drive and was looking for a solution to stream these libraries as distinct entities; I wanted to keep my wife’s library separate mostly so I could keep all of my painstakingly catalouged music organized exactly how I like it. I was already using mt-daapd, now known as the Firefly Media Server, to stream my own library from my Linux server. Unfortunately, it doesn’t support streaming two libraries from one program instance. The solution to this is to run two copies of mt-daapd and configure them to play nice with each other. Don’t worry, it’s not quite as difficult as it sounds. The first thing you’ll need is to have a separate configuration file for the second daap instance. The easiest way to do this is to copy the files from an existing installation (see  for installation instructions).</p>
<p>Run the following commands to copy the configuration and playlist files.</p>
<pre class="highlight"><code class="hljs avrasm"><span class="hljs-keyword">cp</span> /etc/mt-daapd<span class="hljs-preprocessor">.conf</span> /etc/mt-daapd-new_library_name<span class="hljs-preprocessor">.conf</span>
<span class="hljs-keyword">cp</span> /etc/mt-daapd<span class="hljs-preprocessor">.playlist</span> /etc/mt-daapd-new_library_name<span class="hljs-preprocessor">.playlist</span>
</code></pre><p>Now edit the new configuration file and make sure you change all of the following properties:</p>
<ul>
<li>port – 3690 should do.</li>
<li>db_parms – This is the folder containing the sqlite database for your collection. I suggest you suffix the existing name with ‘-new_library_name’ to keep things easily recognizable in the future.</li>
<li>mp3_dir – point to the new collection.</li>
<li>servername – change to a distinct name (new_library_name that you used above) so you can tell them apart.</li>
<li>playlist – point to the playlist file you created in the previous step.</li>
</ul>
<p>Note that mt-daapd will create a sqlite database if one doesn’t already exist but you will need to create the containing folder if it doesn’t already exist and ensure it has the correct permissions (have a look at the permissions on the existing folder). Now you need to test the new configuration works. With your first server still running, execute the following command:</p>
<pre class="highlight"><code class="hljs lasso">mtdaapd <span class="hljs-attribute">-c</span> /etc/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span><span class="hljs-built_in">.</span>conf
</code></pre><p>If everything has worked then running ps -ef | grep mt-daapd should reveal two mt-daapd processes are running. You should now be able to test that both of them are working using a daapd client such as Rhythmbox. Next we need to create an init.d script to start and stop the server at system startup:</p>
<pre class="highlight"><code class="hljs avrasm">sudo <span class="hljs-keyword">cp</span> /etc/init<span class="hljs-preprocessor">.d</span>/mt-daapd /etc/init<span class="hljs-preprocessor">.d</span>/mt-daapd-new_library_name
</code></pre><p>Edit /etc/init.d/mt-daapd-new_library_name and add the following to the properties near the top:</p>
<pre class="highlight"><code class="hljs ini"><span class="hljs-setting">DAEMON_OPTS=<span class="hljs-value"><span class="hljs-string">"-c /etc/mt-daapd-new_library_name.conf"</span></span></span>
</code></pre><p>Change the <code>NAME</code> and <code>DESC</code> properties as follows:</p>
<pre class="highlight"><code class="hljs lasso">NAME<span class="hljs-subst">=</span>mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> 
DESC<span class="hljs-subst">=</span>mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
</code></pre><p>Finally we need to set the boot level of the new instance</p>
<pre class="highlight"><code class="hljs lasso">cd /etc/rc0<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> K25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
cd /etc/rc1<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> K25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
cd /etc/rc2<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> S25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
cd /etc/rc3<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> S25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
cd /etc/rc4<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> S25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
cd /etc/rc5<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> S25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
cd /etc/rc6<span class="hljs-built_in">.</span>d
ln <span class="hljs-attribute">-s</span> /etc/init<span class="hljs-built_in">.</span>d/mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span> K25mt<span class="hljs-attribute">-daapd</span><span class="hljs-attribute">-new_library_name</span>
</code></pre></div><hr/><p>Share this post: <a href="https://twitter.com/intent/tweet?url=http://sookocheff.com/posts/2010-08-03-share-multiple-mt-daap-libraries&amp;text=Share multiple mt-daap libraries&amp;via=soofaloofa"><i class="fa fa-twitter"></i></a>&nbsp;&nbsp;<a href="https://facebook.com/sharer.php?u=http://sookocheff.com/posts/2010-08-03-share-multiple-mt-daap-libraries"><i class="fa fa-facebook"></i></a>&nbsp;&nbsp;<a href="https://plus.google.com/share?url=http://sookocheff.com/posts/2010-08-03-share-multiple-mt-daap-libraries"><i class="fa fa-google-plus"></i></a>&nbsp;&nbsp;<a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://sookocheff.com/posts/2010-08-03-share-multiple-mt-daap-libraries"><i class="fa fa-linkedin"></i></a>&nbsp;&nbsp;<a href="mailto:?subject=Check out this link&amp;body=http://sookocheff.com/posts/2010-08-03-share-multiple-mt-daap-libraries"><i class="fa fa-envelope"></i></a></p><hr/><div class="well"><div class="row"><div class="col-md-8 col-md-offset-2"><h4>About Kevin</h4></div></div><div class="row"><div class="col-md-2 col-md-offset-2"><img src="/img/profile.png"/></div><div class="col-md-6"><p>I am a Software Developer. I work at <a href="http://www.vendasta.com">VendAsta</a>&nbsp;with a bunch of great people. I run a business as <a href="http://redfinchsoftware.com">Red Finch Software</a>. You can find me online as <a href="https://twitter.com/soofaloofa">soofaloofa</a>. I love to teach, learn, speak and write about business and software.</p><p class="lead social-links"><a href="http://www.twitter.com/soofaloofa"><i class="fa fa-twitter-square"></i></a>&nbsp;<a href="http://www.facebook.com/kevin.sookocheff"><i class="fa fa-facebook-square"></i></a>&nbsp;<a href="http://www.linkedin.com/in/kevinsookocheff"><i class="fa fa-linkedin-square"></i></a>&nbsp;<a href="https://plus.google.com/+KevinSookocheff"><i class="fa fa-google-plus-square"></i></a>&nbsp;<a href="https://github.com/soofaloofa"><i class="fa fa-github-square"></i></a>&nbsp;<a href="http://sookocheff.com/rss.xml"><i class="fa fa-rss-square"></i></a></p></div></div></div><hr/><div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'kevinsookocheff'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article></div></section></section></div><div class="container"><hr><!-- Footer--><footer><p class="pull-right"><a href="#" class="pull-right">Top</a></p><p>© Kevin Sookocheff</p></footer></div><!-- Scripts--><script defer="defer"  src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script><script defer="defer"  src="//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script></body></html>